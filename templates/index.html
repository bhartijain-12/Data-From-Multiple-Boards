<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Email Draft UI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      padding: 20px;
    }
    .email-container {
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .email-header {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
    }
    .subject {
      font-weight: bold;
      margin-bottom: 15px;
      color: #222;
    }
    .email-body {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      min-height: 200px;
      background: #fafafa;
      white-space: pre-wrap;
    }
    .actions {
      margin-top: 20px;
      display: flex;
      gap: 12px;
    }
    button {
      padding: 10px 18px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
    }
    .save {
      background: #f0ad4e;
      color: white;
    }
    .send {
      background: #28a745;
      color: white;
    }
  </style>
</head>
<body>
  <div class="email-container">
    <div class="email-header">Generated Email</div>
    
    <div class="subject" id="email-subject">
      Subject: Thank you for your feedback!
    </div>
    
    <div class="email-body" id="email-body" contenteditable="true">
Hi CUST-6002,

Thank you for your wonderful feedback regarding our service speed and reliability. We are thrilled to hear that you are very happy with your experience, and we truly appreciate your loyalty.

To ensure your continued satisfaction, hereâ€™s what we will do:
- Acknowledge your positive feedback about speed and reliability.
- Offer personalized support to assist you further.
- Provide incentives or loyalty rewards to encourage your continued engagement.
- Follow up regularly to address any concerns and maintain our connection.

We are grateful for your trust and look forward to serving you even better in the future. Please feel free to reach out anytime!

Warm regards,
[Your Companyâ€™s Support Team]
    </div>

    <div class="actions">
      <button class="save" onclick="saveDraft()">ðŸ’¾ Save as Draft</button>
      <button class="send" onclick="sendEmail()">ðŸ“¨ Send</button>
    </div>
  </div>

  <script>
    const API_URL = "https://api.monday.com/v2";
    const API_KEY = "eyJhbGciOiJIUzI1NiJ9.eyJ0aWQiOjUxODE2ODIyNiwiYWFpIjoxMSwidWlkIjo3NjM1NTU1NCwiaWFkIjoiMjAyNS0wNS0yN1QxMTo1MTozOC4wMDBaIiwicGVyIjoibWU6d3JpdGUiLCJhY3RpZCI6Mjk2NTAyMjEsInJnbiI6ImFwc2UyIn0.4x5sOTNa8-gYQ9Fb8Lnv8hh2_XQXVYJkhxlfRlUmt0s"; // Replace with your Monday API key
    const BOARD_ID = 123456789;     // Replace with your board_id
    const ITEM_ID = 2053389531;     // Replace with your item_id
    const COLUMN_ID = "long_text_mktx40xq"; // Replace with your column_id

    async function callMondayAPI(query) {
      const response = await fetch(API_URL, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": API_KEY
        },
        body: JSON.stringify({ query })
      });
      return response.json();
    }

    async function saveDraft() {
      const body = document.getElementById("email-body").innerText;

      const query = `
        mutation {
          change_simple_column_value (
            board_id: ${BOARD_ID},
            item_id: ${ITEM_ID},
            column_id: "${COLUMN_ID}",
            value: "${body.replace(/"/g, '\\"')}"
          ) {
            id
          }
        }
      `;

      const result = await callMondayAPI(query);
      console.log("Save Draft result:", result);
      alert("Draft saved âœ…");
      window.close();
    }

    async function sendEmail() {
      const body = document.getElementById("email-body").innerText;

      const query = `
        mutation {
          change_simple_column_value (
            board_id: ${BOARD_ID},
            item_id: ${ITEM_ID},
            column_id: "${COLUMN_ID}",
            value: "${body.replace(/"/g, '\\"')}"
          ) {
            id
          }
        }
      `;

      const result = await callMondayAPI(query);
      console.log("Send Email result:", result);

      // Here you could also update another column (e.g., "send_to_customer" field)
      alert("Email sent to customer ðŸš€");
      window.close();
    }
  </script>
</body>
</html>
